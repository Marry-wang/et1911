<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
	<head>
		<meta charset="UTF-8">
		<title>车辆列表 </title>
		<link th:href="@{/bootstrap/css/bootstrap.min.css}" rel="stylesheet">
		<style>
			.carPage{
				width:260px;
				margin:0 auto ;
				padding-top:20px;
			}
		</style>
	</head>
	<body>
		
		<div class="container-fluid">
			<div class="row" id="carList">
			
			</div>
		</div>
		<div class="carPage">
			<button id="firstPage" class="btn btn-primary" type="button">首页 </button>
			<button id="prePage" class="btn btn-primary" type="button">上一页 </button>
			<button id="nextPage" class="btn btn-primary" type="button">下一页</button>
			<button id="lastPage" class="btn btn-primary" type="button">末页 </button>
		</div>
		
		
		
		
	<script th:src="@{/bootstrap/js/jquery/jquery.min.js}"
		type="text/javascript"></script>
	<script th:src="@{/bootstrap/js/bootstrap.min.js}"
		type="text/javascript"></script>
		
	<script th:src="@{/bootstrap/js/validate/jquery.validate.min.js}"
		type="text/javascript"></script>
	<script th:src="@{/bootstrap/js/validate/messages_zh.min.js}"
		type="text/javascript"></script>
		
	<script th:src="@{/bootstrap/js/laydate/laydate.js}"
		type="text/javascript"></script>
		
	<script th:inline="javascript" type="text/javascript">
		const path= /*[[${#request.getContextPath()}]]*/
		
		
		$(function(){
			et1911.queryList();
			
			$('#firstPage').click(function(){
				et1911.queryList();
			})
			$('#nextPage').click(function(){
				et1911.queryList(++currentPage);
			})
			$('#prePage').click(function(){
				et1911.queryList(--currentPage);
			})
			$('#lastPage').click(function(){
				et1911.queryList(pageCount);
			})
		})
		let currentPage=1;
		let pageCount;
        let et1911={
			queryList:function(pageNum,pageSize){
				pageNum=pageNum||1
				pageSize=pageSize||8
				$.ajax({
					url:path+'/car/list',
					type:'GET',
					data:'pageNum='+pageNum+'&pageSize='+pageSize,
					dataType:'json',
					success:function(res){
						
						let divs="";
						currentPage =res.pageNum;
						pageCount=res.pageCount;
						 
						$.each(res.rows,function(index,car){
							divs += "<div class='col-md-3'>"
								+ "<img class='img-thumbnail' src='" + path + car.pic + "' width='300px;'>"
								+ "<p>"+ car.brand +" "+ "/" +" "+ car.series+"</p>"
								+ "<p>"+ car.price +"万元</p>"
								+ "<p>"+ car.gearboxName +"</p>"
								+ "</div>"
						})	
						$("#carList").html(divs);	
						
						if(res.first){
							$('#firstPage').attr('disabled','disabled')
							$('#prePage').attr('disabled','disabled')
						}else{
							$('#firstPage').removeAttr('disabled')
							$('#prePage').removeAttr('disabled')
						}
						
						if(res.last){
							$('#lastPage').attr('disabled','disabled')
							$('#nextPage').attr('disabled','disabled')
						}else{
							$('#lastPage').removeAttr('disabled')
							$('#nextPage').removeAttr('disabled')
						}
					}
				})			
			}
		}
	
	
	</script>
		
	</body>
</html>